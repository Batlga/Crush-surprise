<!DOCTYPE html>
<html lang="mn">
<head>
<meta charset="UTF-8" />
<title>Зүрхэн цуглуулах тоглоом</title>
<style>
  body {
    margin: 0;
    background: linear-gradient(135deg, #ffe0ec, #ffd1b3);
    overflow: hidden;
  }
  canvas {
    display: block;
    margin: 0 auto;
    background: #fff0f5;
    border: 2px solid #ff6f61;
    border-radius: 15px;
  }
  #score {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    text-align: center;
    font-size: 24px;
    color: #b71c1c;
    margin-top: 10px;
  }
</style>
</head>
<body>

<canvas id="gameCanvas" width="400" height="600"></canvas>
<div id="score">Цуглуулсан зүрхэн: 0</div>

<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');

  const player = {
    x: canvas.width / 2,
    y: canvas.height - 50,
    radius: 20,
    color: '#b71c1c',
    speed: 7,
    dx: 0
  };

  const hearts = [];
  const heartEmoji = "❤️";

  let score = 0;
  let gameOver = false;

  // Товчлуурын үйлдэл
  document.addEventListener('keydown', (e) => {
    if(e.key === 'ArrowLeft') {
      player.dx = -player.speed;
    } else if(e.key === 'ArrowRight') {
      player.dx = player.speed;
    }
  });

  document.addEventListener('keyup', (e) => {
    if(e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
      player.dx = 0;
    }
  });

  // Зүрхэн үүсгэх функц
  function createHeart() {
    const x = Math.random() * (canvas.width - 30) + 15;
    hearts.push({
      x: x,
      y: -30,
      size: 24,
      speed: 2 + Math.random() * 2
    });
  }

  // Тоглоомын шинэчлэлт функц
  function update() {
    if(gameOver) return;

    // Тоглогчийн байрлалыг шинэчлэх
    player.x += player.dx;
    if(player.x - player.radius < 0) player.x = player.radius;
    if(player.x + player.radius > canvas.width) player.x = canvas.width - player.radius;

    // Зүрхэнүүдийг доош шилжүүлэх
    hearts.forEach((heart, index) => {
      heart.y += heart.speed;

      // Тоглогчтой мөргөлдөж байна уу?
      if(
        heart.y + heart.size > player.y - player.radius &&
        heart.x > player.x - player.radius &&
        heart.x < player.x + player.radius
      ) {
        hearts.splice(index,1);
        score++;
        document.getElementById('score').textContent = `Цуглуулсан зүрхэн: ${score}`;
      }
      // Доод талд хүрсэн эсвэл дэлгэцээс гарсан зүрхэн
      else if(heart.y > canvas.height) {
        gameOver = true;
        alert('Тоглоом дууслаа! Цуглуулсан зүрхэн: ' + score);
        location.reload();
      }
    });
  }

  // Тоглоом зурах функц
  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Тоглогчийг зурах (дугуй)
    ctx.beginPath();
    ctx.arc(player.x, player.y, player.radius, 0, Math.PI * 2);
    ctx.fillStyle = player.color;
    ctx.fill();
    ctx.closePath();

    // Зүрхэнүүдийг зурах
    hearts.forEach(heart => {
      ctx.font = `${heart.size}px serif`;
      ctx.fillText(heartEmoji, heart.x, heart.y);
    });
  }

  // Тоглоомын гол цикл
  function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
  }

  // Зүрхэн үүсгэх интервал
  setInterval(() => {
    if(!gameOver) createHeart();
  }, 800);

  // Тоглоом эхлүүлэх
  gameLoop();

</script>

</body>
</html>
